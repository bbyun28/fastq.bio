var FASTQ=function(){function e(){o=i,s={},m={},c={}}function n(e){return null!=e&&"name"in e&&e.name.match(t)}function a(e,a){return n(e)?a[0].match(/^@/)&&a[1].length==a[3].length:!1}function r(e,n,a){e.name in s||(s[e.name]=0,m[e.name]=null,c[e.name]=0);var r=e.name.match(/.gz$/);if(r&&(s[e.name]=0,m[e.name]=null),c[e.name]>n)return void("lastread"in a&&a.lastread());c[e.name]++;var t=new FileReader,d=s[e.name],h=Math.min(d+u,e.size),a=a||{};return r&&(h=u*c[e.name]/4,o=i*c[e.name]*10),"preread"in a&&a.preread(),d>=h||-1==d||-1==h?void("lastread"in a&&a.lastread()):(t.readAsBinaryString(e.slice(d,h)),void(t.onload=function(n){l(e,t),"postread"in a&&a.postread(m[e.name])}))}function l(e,n){var r={},l=n.result,t=o,u=e.name.match(/.gz$/),i=m[e.name];if(r=null==i?{reads:0,avgGC:[],avgQual:[],seqlen:[],nucl:[],qual:[]}:i,u&&(l=new TextDecoder("utf-8").decode(pako.inflate(l))),l=l.split("\n"),l.length<t&&(t=l.length-l.length%4),t-=4,4>t)return console.log("Error: only found "+t+" lines."),void(s[e.name]=-1);for(var c=0;t>c;c+=4){if(!a(e,[l[0],l[c+1],l[c+2],l[c+3]]))return console.log("Invalid FASTQ chunk"),void(s[e.name]=-1);var h=l[c+1],g=l[c+3];r.reads++,r.seqlen.push(h.length);for(var f=0,v=0,p=0,q=0,C=0;C<h.length;C++){null==r.nucl[C]&&(r.nucl[C]={A:0,C:0,G:0,T:0,N:0},r.qual[C]=[]);var z=h[C],A=g[C].charCodeAt()-d;r.nucl[C][z]++,r.qual[C].push(A),f+="C"==h[C]||"G"==h[C]?1:0,v++,p+=A,q++}r.avgGC.push(Math.round(f/v*1e3)/1e3),r.avgQual.push(Math.round(p/q))}console.log("Read "+t+"lines -- "+r.reads+" reads total");for(var F=0,c=0;t>c;c++)F+=l[c].length+1;return u||(s[e.name]+=F),m[e.name]=r,!0}var t=/.fastq|.fq|.fastq.gz|.fq.gz/,u=512e3,o=1e4,i=1e4,d=33,s={},m={},c={};return{isValidFileName:n,getNextChunk:r,reset:e}}();