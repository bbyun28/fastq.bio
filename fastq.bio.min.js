var FASTQ=function(){function e(){i=o,s={},m={},c={}}function n(e){return null!=e&&"name"in e&&e.name.match(t)}function a(e,a){return n(e)?a[0].match(/^@/)&&a[1].length==a[3].length:!1}function r(e,n,a){e.name in s||(s[e.name]=0,m[e.name]=null,c[e.name]=0);var r=e.name.match(/.gz$/);if(r&&(s[e.name]=0,m[e.name]=null),c[e.name]>n)return void("lastread"in a&&a.lastread());c[e.name]++;var t=new FileReader,d=s[e.name],h=Math.min(d+u,e.size),a=a||{};return r&&(h=u*c[e.name]/4,i=o*c[e.name]*10),"preread"in a&&a.preread(),d>=h||-1==d||-1==h?void("lastread"in a&&a.lastread()):(t.readAsBinaryString(e.slice(d,h)),void(t.onload=function(n){l(e,t),"postread"in a&&a.postread(m[e.name])}))}function l(e,n){var r={},l=n.result,t=i,u=e.name.match(/.gz$/),o=m[e.name];if(r=null==o?{reads:0,avgGC:[],avgQual:[],seqlen:[],nucl:[],qual:[]}:o,u){var c=pako.inflate(l);if(0==c.length)return alert("Error: The .gz file specified has an unsupported encoding."),void(s[e.name]=-1);l=new TextDecoder("utf-8").decode(c)}if(l=l.split("\n"),l.length<t&&(t=l.length-l.length%4),t-=4,4>t)return console.log("Error: only found "+t+" lines."),void(s[e.name]=-1);for(var h=0;t>h;h+=4){if(!a(e,[l[0],l[h+1],l[h+2],l[h+3]]))return console.log("Invalid FASTQ chunk"),void(s[e.name]=-1);var f=l[h+1],g=l[h+3];r.reads++,r.seqlen.push(f.length);for(var v=0,p=0,q=0,z=0,C=0;C<f.length;C++){null==r.nucl[C]&&(r.nucl[C]={A:0,C:0,G:0,T:0,N:0},r.qual[C]=[]);var A=f[C],T=g[C].charCodeAt()-d;r.nucl[C][A]++,r.qual[C].push(T),v+="C"==f[C]||"G"==f[C]?1:0,p++,q+=T,z++}r.avgGC.push(Math.round(v/p*1e3)/1e3),r.avgQual.push(Math.round(q/z))}console.log("Read "+t+"lines -- "+r.reads+" reads total");for(var F=0,h=0;t>h;h++)F+=l[h].length+1;return u||(s[e.name]+=F),m[e.name]=r,!0}var t=/.fastq|.fq|.fastq.gz|.fq.gz/,u=512e3,i=1e4,o=1e4,d=33,s={},m={},c={};return{isValidFileName:n,getNextChunk:r,reset:e}}();