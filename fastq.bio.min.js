var FASTQ=function(){function e(){u=i,s={},m={},c={}}function n(e){return null!=e&&"name"in e&&e.name.match(t)}function a(e,a){return n(e)?a[0].match(/^@/)&&a[1].length==a[3].length:!1}function r(e,n,a){e.name in s||(s[e.name]=0,m[e.name]=null,c[e.name]=0);var r=e.name.match(/.gz$/);if(r&&(s[e.name]=0,m[e.name]=null),c[e.name]>n)return void("lastread"in a&&a.lastread());c[e.name]++;var t=new FileReader,d=s[e.name],f=Math.min(d+o,e.size),a=a||{};return r&&(f=o*c[e.name]/4,u=i*c[e.name]*10),"preread"in a&&a.preread(),d>=f||-1==d||-1==f?void("lastread"in a&&a.lastread()):(t.readAsBinaryString(e.slice(d,f)),void(t.onload=function(n){l(e,t),"postread"in a&&a.postread(m[e.name])}))}function l(e,n){var r={},l=n.result,t=u,o=e.name.match(/.gz$/),i=m[e.name];if(r=null==i?{reads:0,avgGC:[],avgQual:[],seqlen:[],nucl:[],qual:[]}:i,o){var c=pako.inflate(l);if(0==c.length)return alert("Error: The .gz file you specified is not supported."),void(s[e.name]=-1);l=new TextDecoder("utf-8").decode(c)}if(l=l.split("\n"),l.length<t&&(t=l.length-l.length%4),t-=4,4>t)return console.log("Error: only found "+t+" lines."),void(s[e.name]=-1);for(var f=0;t>f;f+=4){if(!a(e,[l[0],l[f+1],l[f+2],l[f+3]]))return console.log("Invalid FASTQ chunk"),void(s[e.name]=-1);var h=l[f+1],g=l[f+3];r.reads++,r.seqlen.push(h.length);for(var v=0,p=0,q=0,z=0,C=0;C<h.length;C++){null==r.nucl[C]&&(r.nucl[C]={A:0,C:0,G:0,T:0,N:0},r.qual[C]=[]);var A=h[C],T=g[C].charCodeAt()-d;r.nucl[C][A]++,r.qual[C].push(T),v+="C"==h[C]||"G"==h[C]?1:0,p++,q+=T,z++}r.avgGC.push(Math.round(v/p*1e3)/1e3),r.avgQual.push(Math.round(q/z))}console.log("Read "+t+"lines -- "+r.reads+" reads total");for(var F=0,f=0;t>f;f++)F+=l[f].length+1;return o||(s[e.name]+=F),m[e.name]=r,!0}var t=/.fastq|.fq|.fastq.gz|.fq.gz/,o=512e3,u=1e4,i=1e4,d=33,s={},m={},c={};return{isValidFileName:n,getNextChunk:r,reset:e}}();